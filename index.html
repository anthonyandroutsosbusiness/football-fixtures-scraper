<!DOCTYPE html>
<html>
<head>
    <title>Better Football Weekly Data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <h1>Better Football Weekly Data</h1>
    <p>Data is pulled automatically every Sunday by GitHub. <br>
    Last updated: <span id="last-run">Loading...</span></p>
    
    <h2>Alex Moore 7-a-side Standings</h2>
    <div id="standings-output">Loading standings data...</div>

    <hr>
    
    <h2>Saturday 11s Men's Fixtures (This Week)</h2>
    <div id="sat-fixtures-output">Loading Saturday fixtures...</div>
    
    <h2>Sunday 11s Fixtures (This Week)</h2>
    <div id="sun-fixtures-output">Loading Sunday fixtures...</div>
    
    <script>
        // (Keep the loadData and loadLastRun functions exactly as they were.)
        async function loadData(filename, elementId) {
            try {
                // Fetch the JSON file created by the scraper
                const response = await fetch('data/' + filename); 
                const data = await response.json();
                
                if (data.length === 0) {
                    document.getElementById(elementId).innerHTML = "No data found (or week not yet scheduled).";
                    return;
                }

                // Building the HTML table
                let html = '<table><thead><tr>';
                const headers = Object.keys(data[0]);
                
                headers.forEach(header => {
                    const cleanHeader = header.replace(/_/g, ' ').toUpperCase(); 
                    html += `<th>${cleanHeader}</th>`;
                });
                html += '</tr></thead><tbody>';

                data.forEach(row => {
                    html += '<tr>';
                    headers.forEach(header => {
                        html += `<td>${row[header]}</td>`;
                    });
                    html += '</tr>';
                });

                html += '</tbody></table>';
                document.getElementById(elementId).innerHTML = html;

            } catch (error) {
                document.getElementById(elementId).innerHTML = 'Error loading or parsing data.';
                console.error('Error:', error);
            }
        }
        
        async function loadLastRun() {
            try {
                const logResponse = await fetch('data/last_run.txt');
                const logText = await logResponse.text();
                const lastRunMatch = logText.match(/Last scrape completed: (.*)/);
                if (lastRunMatch) {
                    document.getElementById('last-run').textContent = new Date(lastRunMatch[1]).toLocaleString();
                }
            } catch (error) {
                document.getElementById('last-run').textContent = 'Date not yet available.';
            }
        }
        
        // EXECUTE ALL LOADS:
        loadLastRun();
        
        // Load Standings (using the original filename)
        loadData('alex_moore_standings.json', 'standings-output'); 

        // Load Fixtures (using the new filenames from the scraper)
        loadData('saturday_11s_mens_fixtures.json', 'sat-fixtures-output');
        loadData('sunday_11s_fixtures.json', 'sun-fixtures-output');

    </script>
</body>

</html>
